version: '1'
name: 'SIMPLE_PIPELINE_WITH_CODE_REVIEW'
stages:
  git-clone:
    type: git-clone
    input:
      REPOSITORY_URL: {{payload.repo_url}}
      REPOSITORY_REF: {{payload.repo_ref}}
    output:
    context:
      workspace: {{CLONED_DIR}}
    depends_on:
  build:
    type: node-build
    input:
      WORKSPACE: {{context.workspace}}
    output:
    context:
    depends_on: git-clone
  eslint:
    type: eslint
    input:
      WORKSPACE: {{context.workspace}}
      INCLUDE: {{payload.eslint.include}}
      EXCLUDE: {{payload.eslint.exclude}}
    output:
      payload:
        output:
          lint:
            js: {{OUTPUT}}
    context:
    depends_on:
      - git-clone
  htmlhint:
    type: htmlhint
    input:
      WORKSPACE: {{context.workspace}}
      INCLUDE: {{payload.htmlhint.include}}
      EXCLUDE: {{payload.htmlhint.exclude}}
    output:
      payload:
        output:
          lint:
            html: {{OUTPUT}}
    context:
    depends_on:
      - git-clone
  codecoverage:
    type: codecoverage
    input:
      WORKSPACE: {{context.workspace}}
      INCLUDE: {{payload.codecoverage.include}}
      EXCLUDE: {{payload.codecoverage.exclude}}
    output:
      payload:
        output:
          codecoverage: {{OUTPUT}}
    context:
    depends_on:
      - git-clone
  blackBoxTest:
    type: mocha
    input:
      WORKSPACE: {{context.workspace}}
      INCLUDE: {{payload.blackbox.include}}
      EXCLUDE: {{payload.blackbox.exclude}}
    output:
      payload:
        output:
          blackbox: {{OUTPUT}}
    context:
    depends_on: git-clone
  whiteBoxTest:
    type: mocha
    input:
      WORKSPACE: {{context.workspace}}
      INCLUDE: {{payload.whitebox.include}}
      EXCLUDE: {{payload.whitebox.exclude}}
    output:
      payload:
        output:
          whitebox: {{OUTPUT}}
  unitTest:
    type: mocha
    input:
      WORKSPACE: {{context.workspace}}
      INCLUDE: {{payload.unittest.include}}
      EXCLUDE: {{payload.unittest.exclude}}
    output:
      payload:
        output:
          unittest: {{OUTPUT}}
  code-review:
    type: manual-code-review
    input:
      WORKSPACE: {{context.workspace}}
    output:
      payload:
        output:
          code-review: {{OUTPUT}}
